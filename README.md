# Тестирование логов и базы данных такси
Этот проект состоит из двух частей. Предстоит поработать в консоли с логами и базой данных такси.
## Консоль
### Задание 1
Нужно выяснить, какие запросы шли с IP-адреса. IP-адрес состоит из четырёх чисел, они разделены точками. Нужны адреса, которые начинаются с «233.201.».

Логи лежат на удалённом сервере по адресу logs/2019/12. День, когда случилась ошибка, неизвестен. 

Задача — узнать, какие запросы были отправлены. 

### Задание 2
В системе обнаружен баг. Он проявлялся 30.12.2019 и 31.12.2019 с 21:30:00 до 21:39:59. При этом появлялись ошибки с номерами 400 и 500. Задача — сохранить в отдельный файл логи, которые были записаны в этот период. 

Затем эти логи надо разложить по отдельным файлам: логи с одинаковой ошибкой положи в один файл:
1. В домашней директории на удалённом сервере создай директорию bug1.
2. Все запросы, которые произошли в указанный период, положи в файл main.txt в директорию bug1.
3. Внутри директории bug1 создай директорию events.
4. Внутри директории events создай файлы для ошибок с номерами 400 и 500. Назови эти файлы 400.txt и 500.txt соответственно. В них выдели логи с соответствующей ошибкой из файла main.txt.

## База данных
### Описание данных
База данных о поездках такси в Чикаго:

Таблица neighborhoods — информация о районах города:
- neighborhood_id — код района;
- name — название района.

Таблица cabs — информация о такси:
- cab_id — идентификатор такси;
- vehicle_id — уникальный идентификатор автомобиля;
- company_name — компания, которой принадлежит автомобиль.

Таблица trips — информация о поездках:
- trip_id — код поездки;
- cab_id — идентификатор такси, на котором была совершена поездка;
- start_ts — дата и время начала поездки (время округлено до часа);
- end_ts — дата и время окончания поездки (время округлено до часа);
- duration_seconds — длительность поездки в секундах;
- distance_miles — дальность поездки в милях;
- pickup_location_id — код района города, в котором была начата поездка;
- dropoff_location_id — код района города, в котором завершилась поездка.

Таблица weather_records — информация о погоде:
- record_id — код записи погодных наблюдений;
- ts — дата и время наблюдения (время округлено до часа);
- temperature — температура на момент наблюдения;
- description — краткое описание погодных условий. Например, light rain или scattered clouds.

### Схема таблиц
В базе данных нет прямой связи между таблицами trips и weather_records. Связать эти таблицы можно по времени начала поездки (trips.start_ts) и моменту погодных наблюдений (weather_records.ts).

### Задание 1
Имеется база данных с поездками на такси. По плану на линию обслуживания должно было выйти 10550 автомобилей — эта цифра покрывает спрос пользователей. Команде поступило много жалоб: свободных автомобилей оказалось недостаточно. Сколько такси вышло на линии на самом деле? 

Информация о всех машинах на линии есть в таблице cabs.
1. Зайти на удалённый сервер.
2. Подключиться к базе данных chicago_taxi, используя логин morty и пароль smith.
3. Посчитать, сколько всего автомобилей в таблице cabs. Один автомобиль может принадлежать разным компаниями.

### Задание 2
Посчитаnm количество автомобилей в каждой компании из таблицы cabs. Отсортировать значения по убыванию. Команда предполагает, что некоторые компании не вывели достаточно автомобилей на линию. 

Вывести те компании, в которых меньше 100 автомобилей. Поле с числом автомобилей назови cnt, поле с названием компании — company_name.

Чтобы решить задачу, применить оператор HAVING — аналог WHERE для агрегирующих функций. 

### Задание 3
В приложении такси рассчитывается коэффициент стоимости поездки. Если погода хорошая, значение коэффициента равно 1. Если на улице дождь или шторм, коэффициент повышается до 2. У команды есть гипотеза, что в расчётах коэффициента ошибка. Чтобы проверить расчёт коэффициента, команде нужна выборка данных: разработчик может сверить коэффициент с данными в логах и исправить баг. Задача — получить выборку:
1. Получить описание погодных условий из таблицы weather_records для каждого часа.
2. Разделить все часы на две группы оператором CASE: Bad, если поле description содержит слова rain или storm; Good для всех остальных.
3. Полученное поле назвать weather_conditions.

В результирующей таблице должно быть два поля — дата и час (ts) и weather_conditions.

Сделать выборку за период с 2017-11-05 00:00 по 2017-11-06 00:00.

### Задание 4
После обновления ПО таксопарки стали сообщать, что прибыль, которую они получают, не сходится с данными, которые отдаёт приложение. Разработка предполагает, что проблема может быть в данных о количестве поездок. 

Чтобы определить, есть ли баг, нужно получить выборку с количеством поездок каждого таксопарка за 15 и 16 ноября 2017 года. 
1. Вывеcnb поле company_name. Поле с числом поездок назвать trips_amount и вывести его.
2. Результаты, полученные в поле trips_amount, отсортировать по убыванию.

## Результаты тестирования в Google docs:
[Результаты тестирования](https://docs.google.com/document/d/1CFDjJ2M5xhOE4p9ZzJJNp8c91YSEOoCSQbItemGtRrw/edit?usp=sharing "Google docs")
